<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='defoliate_trees() is the starting point for most analyses of insect
defoliation signals preserved in the growth patterns of trees. It requires
individual-tree standardized measurements from potential host trees and a
tree-ring chronology from a nearby non-host species. First,
defoliate_trees() combines these tree-ring indices by calling gsi() to
perform a "correction" of the host-tree indices to remove the climatic
influences on tree growth as represented by the non-host chronology. This
should isolate a disturbance-related signal. Second, defoliate_trees(), runs
id_defoliation(), which completes a runs analyses to evaluate sequences of
negative departures in the host tree growth series (ngsi) for potential
defoliation events.'><title>Identify defoliation events in host trees — defoliate_trees • dfoliatR</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify defoliation events in host trees — defoliate_trees"><meta property="og:description" content='defoliate_trees() is the starting point for most analyses of insect
defoliation signals preserved in the growth patterns of trees. It requires
individual-tree standardized measurements from potential host trees and a
tree-ring chronology from a nearby non-host species. First,
defoliate_trees() combines these tree-ring indices by calling gsi() to
perform a "correction" of the host-tree indices to remove the climatic
influences on tree growth as represented by the non-host chronology. This
should isolate a disturbance-related signal. Second, defoliate_trees(), runs
id_defoliation(), which completes a runs analyses to evaluate sequences of
negative departures in the host tree growth series (ngsi) for potential
defoliation events.'><meta property="og:image" content="https://chguiterman.github.io/dfoliatR/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dfoliatR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-dfoliatR.html">Introduction to dfoliatR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chguiterman/dfoliatR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Identify defoliation events in host trees</h1>
      <small class="dont-index">Source: <a href="https://github.com/chguiterman/dfoliatR/blob/HEAD/R/main.R" class="external-link"><code>R/main.R</code></a></small>
      <div class="d-none name"><code>defoliate_trees.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>defoliate_trees()</code> is the starting point for most analyses of insect
defoliation signals preserved in the growth patterns of trees. It requires
individual-tree standardized measurements from potential host trees and a
tree-ring chronology from a nearby non-host species. First,
<code>defoliate_trees()</code> combines these tree-ring indices by calling <code><a href="gsi.html">gsi()</a></code> to
perform a "correction" of the host-tree indices to remove the climatic
influences on tree growth as represented by the non-host chronology. This
should isolate a disturbance-related signal. Second, <code>defoliate_trees()</code>, runs
<code><a href="id_defoliation.html">id_defoliation()</a></code>, which completes a runs analyses to evaluate sequences of
negative departures in the host tree growth series (<code>ngsi</code>) for potential
defoliation events.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">defoliate_trees</span><span class="op">(</span></span>
<span>  <span class="va">host_tree</span>,</span>
<span>  nonhost_chron <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  duration_years <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  max_reduction <span class="op">=</span> <span class="op">-</span><span class="fl">1.28</span>,</span>
<span>  bridge_events <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  series_end_event <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  list_output <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>host_tree</dt>
<dd><p>A <code>dplR::rwl</code> object containing the tree-level growth series
for all host trees to be compared to the non-host chronology.</p></dd>


<dt>nonhost_chron</dt>
<dd><p>A <code>dplR::rwl</code> object containing a single non-host
chronology. If blank, defoliation events will be inferred on the host_tree
series as provided. It is incumbent on the user to ensure the host_tree
series are properly prepared for analyses when there is no nonhost_chron
provided.</p></dd>


<dt>duration_years</dt>
<dd><p>The minimum length of time in which the tree is
considered to be in defoliation.</p></dd>


<dt>max_reduction</dt>
<dd><p>The minimum value of <code>ngsi</code> required to be considered a
defoliation event. If a sequence of negative ngsi values does not reach
this threshold, the potential event is rejected. Defaults to -1.28.</p></dd>


<dt>bridge_events</dt>
<dd><p>Binary, defaults to <code>FALSE</code>. This option allows for
successive events that are separated by a single year to be bridged and
become one event. It should be used cautiously and closely evaluated to
ensure the likelihood that the two (or more) events are actually one long
event.</p></dd>


<dt>series_end_event</dt>
<dd><p>Binary, defaults to <code>FALSE</code>. This option allows the
user to identify an event occurring at the time of sampling as a
defoliation event, regardless of duration. Including it will help to
quantify periodicity and extent of an outbreak. This should only be used if
the user has direct knowledge of an ongoing defoliation event when the
trees were sampled.</p></dd>


<dt>list_output</dt>
<dd><p>Defaults to <code>FALSE</code>. This option is to output a long list
object containing a separate data.frame for each series in <code>host_tree</code> that
includes the input series and the <code>nonhost_chron</code>, the corrected series, and
the character string identifying the defoliation events.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>By default this returns a long-form data frame of tree-level growth
suppression indices and identified defoliation events. If <code>list_output = TRUE</code>, it returns a list object with each element containing a data.frame
rwl object of the host and non-host series, plus the outputs from <code><a href="gsi.html">gsi()</a></code>.
The list object is useful for assessing the effects of running <code><a href="gsi.html">gsi()</a></code> on
the host and nonhost data.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Other functions in <code>dfoliatR</code>, like <code><a href="outbreak.html">outbreak()</a></code> and <code><a href="plot_defol.html">plot_defol()</a></code>,
require a long-form data frame identifiable as a <code><a href="defol.html">defol()</a></code> object. Selecting
<code>list_output = TRUE</code> will trigger errors in running other functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load host and non-host data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dmj_h"</span><span class="op">)</span> <span class="co"># Host trees</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dmj_nh"</span><span class="op">)</span> <span class="co"># Non-host chronology</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dmj_defol</span> <span class="op">&lt;-</span> <span class="fu">defoliate_trees</span><span class="op">(</span><span class="va">dmj_h</span>, <span class="va">dmj_nh</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Chris Guiterman, Ann Lynch, Jodi Axelson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

