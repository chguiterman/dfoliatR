<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dfoliatR">
<title>Introduction to dfoliatR • dfoliatR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to dfoliatR">
<meta property="og:description" content="dfoliatR">
<meta property="og:image" content="https://chguiterman.github.io/dfoliatR/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dfoliatR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/intro-to-dfoliatR.html">Introduction to dfoliatR</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/chguiterman/dfoliatR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to dfoliatR</h1>
                        <h4 data-toc-skip class="author">Chris
Guiterman</h4>
            
            <h4 data-toc-skip class="date">2023-08-09</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/chguiterman/dfoliatR/blob/HEAD/vignettes/intro-to-dfoliatR.Rmd" class="external-link"><code>vignettes/intro-to-dfoliatR.Rmd</code></a></small>
      <div class="d-none name"><code>intro-to-dfoliatR.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p><code>dfoliatR</code> is not currently on CRAN. To install
<code>dfoliatR</code> use the <code>devtools</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"chguiterman/dfoliatR"</span><span class="op">)</span></span></code></pre></div>
<p>Once installed, <code>dfoliatR</code> can be called like any other R
package</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://chguiterman.github.io/dfoliatR/">dfoliatR</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p><code>dfoliatR</code> requires two independent datasets:</p>
<ul>
<li><p>Host data: Standardized ring-width series of one or more
individual trees (not site series, and multiple cores per tree need to
be averaged to the tree level). To average cores and obtain individual
tree series, see dplr::treeMean, or use ARSTAN output files (.TRE) with
the summary chronology for each tree.</p></li>
<li><p>Non-host or control data: Usually a standardized tree-ring
chronology (site chronology, not individual tree series) from non-host
tree species. Alternatively, an independent annually-resolved climate
series.</p></li>
</ul>
<p>Both host and non-host data should be formatted in R to match the
<code>dplR::rwl</code> object type.</p>
<p>Data are provided in <code>dfoliatR</code> to demonstrate some of the
utilities of <code>dfoliatR</code>, courtesy of Dr. Ann Lynch.</p>
<p>The first is a collection of Douglas-fir trees sampled for a
reconstruction of western spruce budworm. It is paired with a ponderosa
pine non-host chronology from a nearby site.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dmj_h</span><span class="op">)</span></span></code></pre></div>
<p>The host and non-host objects are directly from <code>dplR</code> in
the form of <code>rwl</code> objects:</p>
<table class="table">
<colgroup>
<col width="7%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="8%">
<col width="11%">
<col width="8%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">DMJ01</th>
<th align="right">DMJ02</th>
<th align="right">DMJ03</th>
<th align="right">DMJ04</th>
<th align="right">DMJ06</th>
<th align="right">DMJ07</th>
<th align="right">DMJ11</th>
<th align="right">DMJ14</th>
<th align="right">DMJ15</th>
<th align="right">DMJ16</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1620</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1.14221</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">1621</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.84523</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">1622</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.39534</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">1623</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.64625</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">1624</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.67192</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">1625</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.61729</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">1626</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.94704</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">1627</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1.21904</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">1628</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.99266</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">1629</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">1.29200</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dmj_nh</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">WIR S</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1675</td>
<td align="right">0.537</td>
</tr>
<tr class="even">
<td align="left">1676</td>
<td align="right">0.780</td>
</tr>
<tr class="odd">
<td align="left">1677</td>
<td align="right">1.188</td>
</tr>
<tr class="even">
<td align="left">1678</td>
<td align="right">1.496</td>
</tr>
<tr class="odd">
<td align="left">1679</td>
<td align="right">0.781</td>
</tr>
<tr class="even">
<td align="left">1680</td>
<td align="right">1.292</td>
</tr>
<tr class="odd">
<td align="left">1681</td>
<td align="right">1.256</td>
</tr>
<tr class="even">
<td align="left">1682</td>
<td align="right">1.117</td>
</tr>
<tr class="odd">
<td align="left">1683</td>
<td align="right">1.840</td>
</tr>
<tr class="even">
<td align="left">1684</td>
<td align="right">0.989</td>
</tr>
</tbody>
</table>
<p>The <code>dfoliatR</code> package also includes a second site for
users to explore:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efk_h</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">efk_nh</span><span class="op">)</span></span></code></pre></div>
<p>All data created and presented in this vignette is available through
the package by the object names used here.</p>
</div>
<div class="section level3">
<h3 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h3>
<p>Analyzing insect outbreak signals from tree rings in
<code>dfoliatR</code> requires a two-step process.</p>
<ol style="list-style-type: decimal">
<li><p>Identify defoliation events on host trees by removing the growth
pattern of non-host trees. Host and non-host trees are presumed to
respond similarly to climate, so this step produces individual
tree-level series of what the two species do NOT share in
common.</p></li>
<li><p>Composite host individual tree series to the site level to assess
the scale of defoliation. Events recorded on more than a threshold
number and/or percentage of trees (e.g., 25%) are considered
outbreaks.</p></li>
</ol>
<p>To identify defoliation events, input the set of host tree series and
the non-host chronology into the <code><a href="../reference/defoliate_trees.html">defoliate_trees()</a></code>
function. Some parameters regarding the length and severity of growth
departure can be changed by the user. The parameter defaults follow
those in OUTBREAK (negative departures for 8 or more years, at least one
reaching -1.28 standard deviations, and allowing 1 positive excursion
before and after the greatest departure). Definitions of the function
parameters are provided with <code><a href="../reference/defoliate_trees.html">?defoliate_trees</a></code></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dmj_defol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defoliate_trees.html">defoliate_trees</a></span><span class="op">(</span>host_tree <span class="op">=</span> <span class="va">dmj_h</span>, nonhost_chron <span class="op">=</span> <span class="va">dmj_nh</span>, </span>
<span>      duration_years <span class="op">=</span> <span class="fl">8</span>, max_reduction <span class="op">=</span> <span class="op">-</span><span class="fl">1.28</span>, list_output <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">year</th>
<th align="left">series</th>
<th align="right">gsi</th>
<th align="right">ngsi</th>
<th align="left">defol_status</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1810</td>
<td align="left">DMJ01</td>
<td align="right">1.0830</td>
<td align="right">0.3084</td>
<td align="left">nd</td>
</tr>
<tr class="even">
<td align="right">1811</td>
<td align="left">DMJ01</td>
<td align="right">1.0261</td>
<td align="right">0.1024</td>
<td align="left">nd</td>
</tr>
<tr class="odd">
<td align="right">1812</td>
<td align="left">DMJ01</td>
<td align="right">1.0971</td>
<td align="right">0.3595</td>
<td align="left">nd</td>
</tr>
<tr class="even">
<td align="right">1813</td>
<td align="left">DMJ01</td>
<td align="right">0.9828</td>
<td align="right">-0.0546</td>
<td align="left">nd</td>
</tr>
<tr class="odd">
<td align="right">1814</td>
<td align="left">DMJ01</td>
<td align="right">1.0339</td>
<td align="right">0.1307</td>
<td align="left">nd</td>
</tr>
<tr class="even">
<td align="right">1815</td>
<td align="left">DMJ01</td>
<td align="right">1.3461</td>
<td align="right">1.2616</td>
<td align="left">nd</td>
</tr>
<tr class="odd">
<td align="right">1816</td>
<td align="left">DMJ01</td>
<td align="right">1.4440</td>
<td align="right">1.6166</td>
<td align="left">nd</td>
</tr>
<tr class="even">
<td align="right">1817</td>
<td align="left">DMJ01</td>
<td align="right">0.9790</td>
<td align="right">-0.0682</td>
<td align="left">nd</td>
</tr>
<tr class="odd">
<td align="right">1818</td>
<td align="left">DMJ01</td>
<td align="right">0.7929</td>
<td align="right">-0.7424</td>
<td align="left">nd</td>
</tr>
<tr class="even">
<td align="right">1819</td>
<td align="left">DMJ01</td>
<td align="right">0.9078</td>
<td align="right">-0.3264</td>
<td align="left">nd</td>
</tr>
</tbody>
</table>
<p>The best way to evaluate the results of the call to
<code>defoliate_trees</code> is to graph the resulting “defol”
object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dmj_defol</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dfoliatR_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Each horizontal line in the plot provides the measured time sequence
for each tree. Defoliation events are shown as thicker line segments,
with colors to indicate the relative severity of each event. Breakpoints
to distinguish between severe, moderate, and minor defoliation levels
can be set via the <code>breaks</code> parameter in <code>plot</code> or
<code>plot_defol</code>.</p>
<p>Basic and informative tree-level statistics regarding the sample data
and defoliation events are provided.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/defol_stats.html">defol_stats</a></span><span class="op">(</span><span class="va">dmj_defol</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">series</th>
<th align="right">first</th>
<th align="right">last</th>
<th align="right">years</th>
<th align="right">n_events</th>
<th align="right">tot_years</th>
<th align="right">mean_duration</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DMJ01</td>
<td align="right">1810</td>
<td align="right">1996</td>
<td align="right">187</td>
<td align="right">4</td>
<td align="right">50</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">DMJ02</td>
<td align="right">1750</td>
<td align="right">1996</td>
<td align="right">247</td>
<td align="right">6</td>
<td align="right">75</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">DMJ03</td>
<td align="right">1830</td>
<td align="right">1996</td>
<td align="right">167</td>
<td align="right">4</td>
<td align="right">42</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">DMJ04</td>
<td align="right">1720</td>
<td align="right">1996</td>
<td align="right">277</td>
<td align="right">8</td>
<td align="right">90</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="left">DMJ06</td>
<td align="right">1700</td>
<td align="right">1996</td>
<td align="right">297</td>
<td align="right">6</td>
<td align="right">81</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">DMJ07</td>
<td align="right">1710</td>
<td align="right">1996</td>
<td align="right">287</td>
<td align="right">7</td>
<td align="right">96</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">DMJ11</td>
<td align="right">1900</td>
<td align="right">1997</td>
<td align="right">98</td>
<td align="right">2</td>
<td align="right">19</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">DMJ14</td>
<td align="right">1675</td>
<td align="right">1996</td>
<td align="right">322</td>
<td align="right">9</td>
<td align="right">112</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">DMJ15</td>
<td align="right">1730</td>
<td align="right">1996</td>
<td align="right">267</td>
<td align="right">4</td>
<td align="right">64</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">DMJ16</td>
<td align="right">1746</td>
<td align="right">1996</td>
<td align="right">251</td>
<td align="right">7</td>
<td align="right">86</td>
<td align="right">12</td>
</tr>
</tbody>
</table>
<p>It is important to note that <code>dfoliatR</code> distinguishes
between a “defoliation event” that is recorded on individual trees and
an “outbreak” that synchronously effected a proportion of trees.</p>
<p>Outbreak periods can be identified with the function
<code><a href="../reference/outbreak.html">outbreak()</a></code>. In essence, this is a composite function that
combines all trees provided in the “defol” object to assess the
synchrony and scale of defoliation. Should enough trees record
defoliation (regardless of the duration), it will be termed an
“outbreak”. Filtering parameters control the percent of trees in
defoliation and minimum number of trees required to be considered an
outbreak.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dmj_obr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outbreak.html">outbreak</a></span><span class="op">(</span><span class="va">dmj_defol</span>, filter_perc <span class="op">=</span> <span class="fl">25</span>, filter_min_series <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Running <code>outbreak</code> produces a new class of data frame, an
“outbreak” object.</p>
<table class="table">
<colgroup>
<col width="4%">
<col width="10%">
<col width="9%">
<col width="10%">
<col width="13%">
<col width="14%">
<col width="8%">
<col width="9%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="right">year</th>
<th align="right">samp_depth</th>
<th align="right">num_defol</th>
<th align="right">perc_defol</th>
<th align="right">num_max_defol</th>
<th align="right">perc_max_defol</th>
<th align="right">mean_gsi</th>
<th align="right">mean_ngsi</th>
<th align="left">outbreak_status</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1675</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1.5303</td>
<td align="right">1.5145</td>
<td align="left">not_obr</td>
</tr>
<tr class="even">
<td align="right">1676</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1.2435</td>
<td align="right">0.7143</td>
<td align="left">not_obr</td>
</tr>
<tr class="odd">
<td align="right">1677</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">50.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.9222</td>
<td align="right">-0.1820</td>
<td align="left">not_obr</td>
</tr>
<tr class="even">
<td align="right">1678</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">50.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.9716</td>
<td align="right">-0.0442</td>
<td align="left">not_obr</td>
</tr>
<tr class="odd">
<td align="right">1679</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">50.0</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">1.1373</td>
<td align="right">0.4198</td>
<td align="left">not_obr</td>
</tr>
<tr class="even">
<td align="right">1680</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">33.3</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.7244</td>
<td align="right">-0.7303</td>
<td align="left">outbreak</td>
</tr>
<tr class="odd">
<td align="right">1681</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">33.3</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.5545</td>
<td align="right">-1.2048</td>
<td align="left">outbreak</td>
</tr>
<tr class="even">
<td align="right">1682</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">33.3</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.7372</td>
<td align="right">-0.6983</td>
<td align="left">outbreak</td>
</tr>
<tr class="odd">
<td align="right">1683</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">66.7</td>
<td align="right">1</td>
<td align="right">33.3</td>
<td align="right">0.3466</td>
<td align="right">-1.7847</td>
<td align="left">outbreak</td>
</tr>
<tr class="even">
<td align="right">1684</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">66.7</td>
<td align="right">0</td>
<td align="right">0.0</td>
<td align="right">0.6063</td>
<td align="right">-1.0589</td>
<td align="left">outbreak</td>
</tr>
</tbody>
</table>
<p>As with “defol” objects, it can be plotted directly, and summary
statistics are available.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_outbreak.html">plot_outbreak</a></span><span class="op">(</span><span class="va">dmj_obr</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-dfoliatR_files/figure-html/unnamed-chunk-13-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dmj_obr_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/outbreak_stats.html">outbreak_stats</a></span><span class="op">(</span><span class="va">dmj_obr</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dmj_obr_stats</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="6%">
<col width="5%">
<col width="9%">
<col width="11%">
<col width="14%">
<col width="11%">
<col width="10%">
<col width="12%">
<col width="8%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="right">start</th>
<th align="right">end</th>
<th align="right">duration</th>
<th align="right">n_df_start</th>
<th align="right">perc_df_start</th>
<th align="right">max_df_obr</th>
<th align="right">yr_max_df</th>
<th align="right">yr_min_ngsi</th>
<th align="right">min_gsi</th>
<th align="right">min_ngsi</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1680</td>
<td align="right">1699</td>
<td align="right">20</td>
<td align="right">1</td>
<td align="right">33.3</td>
<td align="right">3</td>
<td align="right">1690</td>
<td align="right">1692</td>
<td align="right">0.121</td>
<td align="right">-2.407</td>
</tr>
<tr class="even">
<td align="right">1753</td>
<td align="right">1769</td>
<td align="right">17</td>
<td align="right">6</td>
<td align="right">46.2</td>
<td align="right">7</td>
<td align="right">1754</td>
<td align="right">1755</td>
<td align="right">0.343</td>
<td align="right">-1.611</td>
</tr>
<tr class="odd">
<td align="right">1825</td>
<td align="right">1840</td>
<td align="right">16</td>
<td align="right">11</td>
<td align="right">78.6</td>
<td align="right">12</td>
<td align="right">1831</td>
<td align="right">1826</td>
<td align="right">0.500</td>
<td align="right">-1.304</td>
</tr>
<tr class="even">
<td align="right">1849</td>
<td align="right">1865</td>
<td align="right">17</td>
<td align="right">7</td>
<td align="right">46.7</td>
<td align="right">13</td>
<td align="right">1852</td>
<td align="right">1853</td>
<td align="right">0.252</td>
<td align="right">-1.994</td>
</tr>
<tr class="odd">
<td align="right">1881</td>
<td align="right">1895</td>
<td align="right">15</td>
<td align="right">8</td>
<td align="right">53.3</td>
<td align="right">14</td>
<td align="right">1886</td>
<td align="right">1885</td>
<td align="right">0.262</td>
<td align="right">-1.945</td>
</tr>
<tr class="even">
<td align="right">1959</td>
<td align="right">1970</td>
<td align="right">12</td>
<td align="right">7</td>
<td align="right">41.2</td>
<td align="right">15</td>
<td align="right">1960</td>
<td align="right">1965</td>
<td align="right">0.328</td>
<td align="right">-1.830</td>
</tr>
<tr class="odd">
<td align="right">1987</td>
<td align="right">1996</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">52.9</td>
<td align="right">15</td>
<td align="right">1989</td>
<td align="right">1995</td>
<td align="right">0.378</td>
<td align="right">-1.640</td>
</tr>
</tbody>
</table>
<p>The summary statistics for “outbreak” objects include each identified
outbreak event as a row, with start/end years, duration, and other
metrics used for analyses.</p>
<p>One important metric to analyze is the return interval of outbreaks.
Many researchers use the first year of the event as the point of
reference. One can calculate return intervals for our DMJ site in this
way via</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dmj_interv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">dmj_obr_stats</span><span class="op">$</span><span class="va">start</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All intervals</span></span>
<span><span class="va">dmj_interv</span></span>
<span><span class="co">#&gt; [1] 73 72 24 32 78 28</span></span>
<span></span>
<span><span class="co"># Mean interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dmj_interv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 51.16667</span></span>
<span></span>
<span><span class="co"># Median interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">dmj_interv</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 52</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Chris Guiterman, Ann Lynch, Jodi Axelson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
